---
name: excel-report-generator
description: Automatically generate Excel reports from data sources including CSV, databases, or Python data structures. Supports data analysis reports, business reports, data export, and template-based report generation using pandas and openpyxl. Activate when users mention Excel, spreadsheet, report generation, data export, or business reporting.
---

# Excel Report Generator

è‡ªåŠ¨åŒ– Excel æŠ¥è¡¨ç”Ÿæˆå·¥å…·ï¼Œæ”¯æŒä»å¤šç§æ•°æ®æºç”Ÿæˆä¸“ä¸šçš„ Excel æŠ¥å‘Šã€‚

## åŠŸèƒ½æ¦‚è¿°

è¿™ä¸ª Skill å¯ä»¥å¸®åŠ©ä½ ï¼š
- ğŸ“Š ä» CSVã€æ•°æ®åº“æˆ– Python æ•°æ®ç»“æ„ç”Ÿæˆ Excel æŠ¥è¡¨
- ğŸ“ˆ åˆ›å»ºåŒ…å«å›¾è¡¨ã€æ ¼å¼åŒ–å’Œå…¬å¼çš„æ•°æ®åˆ†ææŠ¥å‘Š
- ğŸ“‹ åŸºäºæ¨¡æ¿å¡«å……æ•°æ®ç”Ÿæˆä¸šåŠ¡æŠ¥å‘Š
- ğŸ’¾ å°†ç³»ç»Ÿæ•°æ®æ‰¹é‡å¯¼å‡ºä¸ºæ ¼å¼åŒ–çš„ Excel æ–‡ä»¶
- ğŸ¨ åº”ç”¨ä¸“ä¸šçš„æ ·å¼ã€é¢œè‰²å’Œæ¡ä»¶æ ¼å¼

## æ ¸å¿ƒæŠ€æœ¯æ ˆ

- **pandas**: æ•°æ®å¤„ç†å’Œåˆ†æ
- **openpyxl**: Excel æ–‡ä»¶è¯»å†™å’Œæ ¼å¼åŒ–
- **xlsxwriter**: é«˜çº§å›¾è¡¨å’Œæ ¼å¼æ”¯æŒï¼ˆå¯é€‰ï¼‰

## ä½¿ç”¨åœºæ™¯

### 1. æ•°æ®åˆ†ææŠ¥è¡¨
ä»åŸå§‹æ•°æ®ç”ŸæˆåŒ…å«ç»Ÿè®¡åˆ†æã€é€è§†è¡¨å’Œå¯è§†åŒ–å›¾è¡¨çš„ç»¼åˆæŠ¥å‘Šã€‚

**ç¤ºä¾‹è¯·æ±‚**:
- "å¸®æˆ‘ä»è¿™ä¸ª CSV ç”Ÿæˆé”€å”®åˆ†ææŠ¥è¡¨"
- "åˆ›å»ºä¸€ä¸ªåŒ…å«æœˆåº¦è¶‹åŠ¿å›¾çš„æ•°æ®åˆ†æ Excel"
- "ç”Ÿæˆå¸¦æœ‰ç»Ÿè®¡æ±‡æ€»çš„è´¢åŠ¡æŠ¥è¡¨"

### 2. ä¸šåŠ¡æŠ¥å‘Š
å®šæœŸç”Ÿæˆæ ‡å‡†åŒ–çš„ä¸šåŠ¡æŠ¥å‘Šï¼Œå¦‚é”€å”®æŠ¥å‘Šã€KPI ä»ªè¡¨æ¿ç­‰ã€‚

**ç¤ºä¾‹è¯·æ±‚**:
- "ç”Ÿæˆæœ¬æœˆçš„é”€å”®ä¸šç»©æŠ¥å‘Š"
- "åˆ›å»º KPI è·Ÿè¸ªæŠ¥è¡¨"
- "å¯¼å‡ºå­£åº¦ä¸šåŠ¡æ€»ç»“ Excel"

### 3. æ•°æ®å¯¼å‡º
å°†æ•°æ®åº“æŸ¥è¯¢ç»“æœæˆ–ç³»ç»Ÿæ•°æ®å¯¼å‡ºä¸ºæ ¼å¼åŒ–çš„ Excel æ–‡ä»¶ã€‚

**ç¤ºä¾‹è¯·æ±‚**:
- "æŠŠç”¨æˆ·æ•°æ®å¯¼å‡ºåˆ° Excel"
- "å°†æ•°æ®åº“æŸ¥è¯¢ç»“æœä¿å­˜ä¸º Excel æ–‡ä»¶"
- "å¯¼å‡ºå¤šä¸ªå·¥ä½œè¡¨çš„æ•°æ®é›†"

### 4. æ¨¡æ¿å¡«å……
åŸºäºé¢„å®šä¹‰çš„ Excel æ¨¡æ¿å¡«å……åŠ¨æ€æ•°æ®ã€‚

**ç¤ºä¾‹è¯·æ±‚**:
- "ä½¿ç”¨è¿™ä¸ªæ¨¡æ¿ç”ŸæˆæŠ¥å‘Š"
- "å¡«å…… Excel æ¨¡æ¿ä¸­çš„æ•°æ®"
- "æ‰¹é‡ç”ŸæˆåŸºäºæ¨¡æ¿çš„å‘ç¥¨"

## ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬å·¥ä½œæµç¨‹

1. **å‡†å¤‡æ•°æ®æº**: CSV æ–‡ä»¶ã€pandas DataFrameã€æ•°æ®åº“è¿æ¥æˆ– Python å­—å…¸
2. **å®šä¹‰æŠ¥è¡¨éœ€æ±‚**: æè¿°æ‰€éœ€çš„æ ¼å¼ã€å›¾è¡¨ã€æ ·å¼
3. **ç”ŸæˆæŠ¥è¡¨**: è‡ªåŠ¨åˆ›å»ºæ ¼å¼åŒ–çš„ Excel æ–‡ä»¶
4. **éªŒè¯è¾“å‡º**: æ£€æŸ¥ç”Ÿæˆçš„æ–‡ä»¶æ˜¯å¦ç¬¦åˆè¦æ±‚

### å‘½ä»¤ç¤ºä¾‹

**ä» CSV ç”ŸæˆæŠ¥è¡¨**:
```
è¯·ä» sales_data.csv ç”Ÿæˆä¸€ä¸ªé”€å”®åˆ†ææŠ¥è¡¨ï¼ŒåŒ…å«ï¼š
- æŒ‰äº§å“åˆ†ç±»çš„é”€å”®æ±‡æ€»
- æœˆåº¦é”€å”®è¶‹åŠ¿å›¾
- Top 10 äº§å“æ’å
```

**ä» DataFrame ç”ŸæˆæŠ¥è¡¨**:
```
æˆ‘æœ‰ä¸€ä¸ª pandas DataFrameï¼Œå¸®æˆ‘ç”Ÿæˆ Excel æŠ¥è¡¨ï¼ŒåŒ…æ‹¬ï¼š
- æ•°æ®é€è§†è¡¨
- æ¡ä»¶æ ¼å¼é«˜äº®å¼‚å¸¸å€¼
- è‡ªåŠ¨ç­›é€‰å’Œå†»ç»“é¦–è¡Œ
```

**ä½¿ç”¨æ¨¡æ¿**:
```
åŸºäº templates/monthly_report.xlsx æ¨¡æ¿ï¼Œå¡«å……å½“æœˆæ•°æ®å¹¶ç”ŸæˆæŠ¥å‘Š
```

## å®ç°æŒ‡å—

å½“ç”¨æˆ·è¯·æ±‚ç”Ÿæˆ Excel æŠ¥è¡¨æ—¶ï¼Œéµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

### Step 1: æ•°æ®å‡†å¤‡
```python
import pandas as pd
from openpyxl import load_workbook
from openpyxl.styles import Font, PatternFill, Alignment
from openpyxl.utils.dataframe import dataframe_to_rows

# è¯»å–æ•°æ®
df = pd.read_csv('data.csv')
# æˆ–ä»æ•°æ®åº“
# df = pd.read_sql(query, connection)
```

### Step 2: æ•°æ®å¤„ç†
```python
# æ•°æ®æ¸…æ´—å’Œè½¬æ¢
df_clean = df.dropna()

# ç»Ÿè®¡åˆ†æ
summary = df.groupby('category').agg({
    'sales': ['sum', 'mean', 'count'],
    'profit': 'sum'
})
```

### Step 3: åˆ›å»º Excel æ–‡ä»¶
```python
# ä½¿ç”¨ pandas ExcelWriter
with pd.ExcelWriter('output.xlsx', engine='openpyxl') as writer:
    # å†™å…¥åŸå§‹æ•°æ®
    df_clean.to_excel(writer, sheet_name='Raw Data', index=False)

    # å†™å…¥æ±‡æ€»æ•°æ®
    summary.to_excel(writer, sheet_name='Summary')

    # è·å– workbook è¿›è¡Œæ ¼å¼åŒ–
    workbook = writer.book
    worksheet = writer.sheets['Summary']
```

### Step 4: æ ¼å¼åŒ–å’Œæ ·å¼
```python
# æ ‡é¢˜æ ·å¼
header_font = Font(bold=True, color='FFFFFF')
header_fill = PatternFill(start_color='4472C4', end_color='4472C4', fill_type='solid')

# åº”ç”¨æ ·å¼åˆ°æ ‡é¢˜è¡Œ
for cell in worksheet[1]:
    cell.font = header_font
    cell.fill = header_fill
    cell.alignment = Alignment(horizontal='center')

# åˆ—å®½è‡ªåŠ¨è°ƒæ•´
for column in worksheet.columns:
    max_length = 0
    column_letter = column[0].column_letter
    for cell in column:
        if len(str(cell.value)) > max_length:
            max_length = len(str(cell.value))
    worksheet.column_dimensions[column_letter].width = max_length + 2
```

### Step 5: æ·»åŠ å›¾è¡¨ï¼ˆå¯é€‰ï¼‰
```python
from openpyxl.chart import BarChart, Reference

# åˆ›å»ºå›¾è¡¨
chart = BarChart()
chart.title = "Sales by Category"
chart.x_axis.title = "Category"
chart.y_axis.title = "Sales"

# æ•°æ®å¼•ç”¨
data = Reference(worksheet, min_col=2, min_row=1, max_row=10)
categories = Reference(worksheet, min_col=1, min_row=2, max_row=10)

chart.add_data(data, titles_from_data=True)
chart.set_categories(categories)

# æ·»åŠ åˆ°å·¥ä½œè¡¨
worksheet.add_chart(chart, "E5")
```

## é«˜çº§åŠŸèƒ½

### æ¡ä»¶æ ¼å¼
```python
from openpyxl.formatting.rule import ColorScaleRule, CellIsRule

# è‰²é˜¶æ ¼å¼
worksheet.conditional_formatting.add(
    'B2:B100',
    ColorScaleRule(start_type='min', start_color='FF6347',
                   mid_type='percentile', mid_value=50, mid_color='FFFF00',
                   end_type='max', end_color='90EE90')
)

# åŸºäºè§„åˆ™çš„æ ¼å¼
red_fill = PatternFill(start_color='FFC7CE', end_color='FFC7CE', fill_type='solid')
worksheet.conditional_formatting.add(
    'C2:C100',
    CellIsRule(operator='lessThan', formula=['0'], fill=red_fill)
)
```

### æ•°æ®éªŒè¯
```python
from openpyxl.worksheet.datavalidation import DataValidation

# ä¸‹æ‹‰åˆ—è¡¨
dv = DataValidation(type="list", formula1='"ä¼˜ç§€,è‰¯å¥½,ä¸€èˆ¬,è¾ƒå·®"', allow_blank=True)
worksheet.add_data_validation(dv)
dv.add('D2:D100')
```

### å…¬å¼åº”ç”¨
```python
# æ·»åŠ æ±‚å’Œå…¬å¼
worksheet['B11'] = '=SUM(B2:B10)'

# æ·»åŠ å¹³å‡å€¼å…¬å¼
worksheet['C11'] = '=AVERAGE(C2:C10)'
```

## æœ€ä½³å®è·µ

### 1. æ€§èƒ½ä¼˜åŒ–
- å¯¹äºå¤§æ•°æ®é›†ï¼ˆ>10ä¸‡è¡Œï¼‰ï¼Œä½¿ç”¨ `openpyxl` çš„ `write_only` æ¨¡å¼
- åˆ†æ‰¹å¤„ç†æ•°æ®ï¼Œé¿å…å†…å­˜æº¢å‡º
- ä½¿ç”¨ `xlsxwriter` å¼•æ“å¤„ç†å¤æ‚å›¾è¡¨å’Œæ ¼å¼

### 2. é”™è¯¯å¤„ç†
```python
try:
    df = pd.read_csv('data.csv')
except FileNotFoundError:
    print("æ•°æ®æ–‡ä»¶ä¸å­˜åœ¨")
except pd.errors.EmptyDataError:
    print("æ•°æ®æ–‡ä»¶ä¸ºç©º")
```

### 3. æ–‡ä»¶å‘½åè§„èŒƒ
```python
from datetime import datetime

# ä½¿ç”¨æ—¶é—´æˆ³é¿å…æ–‡ä»¶è¦†ç›–
timestamp = datetime.now().strftime('%Y%m%d_%H%M%S')
filename = f'sales_report_{timestamp}.xlsx'
```

### 4. æ•°æ®éªŒè¯
```python
# æ£€æŸ¥å¿…éœ€åˆ—
required_columns = ['date', 'product', 'sales']
if not all(col in df.columns for col in required_columns):
    raise ValueError(f"ç¼ºå°‘å¿…éœ€åˆ—: {required_columns}")

# æ•°æ®ç±»å‹éªŒè¯
df['date'] = pd.to_datetime(df['date'])
df['sales'] = pd.to_numeric(df['sales'], errors='coerce')
```

### 5. æ¨¡æ¿ç®¡ç†
- å°†å¸¸ç”¨æ¨¡æ¿å­˜æ”¾åœ¨ `~/.claude/skills/excel-report-generator/templates/` ç›®å½•
- ä½¿ç”¨ç›¸å¯¹è·¯å¾„å¼•ç”¨: `templates/monthly_report.xlsx`
- ä¿æŒæ¨¡æ¿ç®€æ´ï¼ŒåªåŒ…å«ç»“æ„å’Œæ ·å¼ï¼Œä¸åŒ…å«æ•°æ®

## å¿«é€Ÿå‚è€ƒ

### å¸¸ç”¨ä»£ç ç‰‡æ®µ

æŸ¥çœ‹ `examples/quick_reference.py` è·å–å¸¸ç”¨ä»£ç ç‰‡æ®µï¼ŒåŒ…æ‹¬ï¼š
- åŸºæœ¬ Excel åˆ›å»º
- å¤šå·¥ä½œè¡¨ç®¡ç†
- æ ·å¼å’Œæ ¼å¼åŒ–
- å›¾è¡¨åˆ›å»º
- æ¡ä»¶æ ¼å¼
- å…¬å¼åº”ç”¨

### ç¤ºä¾‹æ–‡ä»¶

- `examples/basic_report.py` - åŸºç¡€æŠ¥è¡¨ç”Ÿæˆç¤ºä¾‹
- `examples/advanced_report.py` - é«˜çº§åŠŸèƒ½ç¤ºä¾‹
- `examples/template_fill.py` - æ¨¡æ¿å¡«å……ç¤ºä¾‹
- `templates/business_report.xlsx` - ä¸šåŠ¡æŠ¥å‘Šæ¨¡æ¿
- `templates/data_analysis.xlsx` - æ•°æ®åˆ†ææ¨¡æ¿

## ä¾èµ–å®‰è£…

ç¡®ä¿å·²å®‰è£…å¿…éœ€çš„ Python åŒ…ï¼š

```bash
pip install pandas openpyxl xlsxwriter
```

å¯é€‰ä¾èµ–ï¼š
```bash
pip install matplotlib seaborn  # ç”¨äºæ•°æ®å¯è§†åŒ–
pip install sqlalchemy pymysql  # ç”¨äºæ•°æ®åº“è¿æ¥
```

## æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

**Q: ç”Ÿæˆçš„ Excel æ–‡ä»¶æ— æ³•æ‰“å¼€**
A: ç¡®ä¿ä½¿ç”¨ `.xlsx` æ‰©å±•åï¼Œæ£€æŸ¥æ–‡ä»¶æƒé™ï¼ŒéªŒè¯æ•°æ®ä¸­æ²¡æœ‰éæ³•å­—ç¬¦

**Q: å›¾è¡¨ä¸æ˜¾ç¤º**
A: æ£€æŸ¥æ•°æ®å¼•ç”¨èŒƒå›´æ˜¯å¦æ­£ç¡®ï¼Œç¡®ä¿æ•°æ®ç±»å‹ä¸ºæ•°å€¼å‹

**Q: ä¸­æ–‡ä¹±ç **
A: ä½¿ç”¨ `encoding='utf-8-sig'` è¯»å– CSVï¼Œæˆ–åœ¨ Excel ä¸­ä½¿ç”¨ UTF-8 ç¼–ç 

**Q: å¤§æ–‡ä»¶ç”Ÿæˆå¾ˆæ…¢**
A: ä½¿ç”¨ `write_only=True` æ¨¡å¼ï¼Œå‡å°‘æ ¼å¼åŒ–æ“ä½œï¼Œåˆ†æ‰¹å†™å…¥æ•°æ®

## ç›¸å…³èµ„æº

- [pandas å®˜æ–¹æ–‡æ¡£](https://pandas.pydata.org/docs/)
- [openpyxl å®˜æ–¹æ–‡æ¡£](https://openpyxl.readthedocs.io/)
- [xlsxwriter å®˜æ–¹æ–‡æ¡£](https://xlsxwriter.readthedocs.io/)
- æŸ¥çœ‹ `REFERENCE.md` è·å–è¯¦ç»† API å‚è€ƒ

## ç‰ˆæœ¬å†å²

- v1.0.0 (2025-01-12) - åˆå§‹ç‰ˆæœ¬ï¼Œæ”¯æŒåŸºç¡€æŠ¥è¡¨ç”Ÿæˆå’Œæ¨¡æ¿å¡«å……
